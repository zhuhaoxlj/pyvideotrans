# ğŸ” åŒ¹é…ç®—æ³•é—®é¢˜è¯Šæ–­ä¸ä¿®å¤

## ğŸ“Š å½“å‰çŠ¶å†µ
- **LLM è¾“å‡ºï¼š** 133 æ¡
- **æˆåŠŸåŒ¹é…ï¼š** 88 æ¡ (66%)
- **å¤±è´¥ï¼š** 45 æ¡ (34%)

---

## ğŸ¯ ä¸‰ä¸ªå¯èƒ½çš„åŸå› 

### åŸå› 1ï¼šåŒ¹é…ç®—æ³•é—®é¢˜ âœ…
**è¡¨ç°ï¼š**
- æŸäº›æ˜æ˜¾å­˜åœ¨çš„æ–‡æœ¬æ— æ³•åŒ¹é…
- ä¾‹å¦‚ï¼š"And that was just luck." åœ¨åŸå§‹å­—å¹•ä¸­å­˜åœ¨ï¼ŒLLMä¹Ÿè¾“å‡ºäº†ï¼Œä½†åŒ¹é…å¤±è´¥

**è¯Šæ–­æ–¹æ³•ï¼š**
```
âš ï¸  Segment 52 æ— æ³•åŒ¹é…
   å½“å‰ word_idx: 550/1230
   æ–‡æœ¬: "And that was just luck."
   é™„è¿‘çš„è¯: [å°†æ˜¾ç¤ºWhisperè¯†åˆ«çš„è¯]  â† æ–°å¢ï¼
```

**å¯èƒ½çš„å­é—®é¢˜ï¼š**
- åŒ¹é…é˜ˆå€¼å¤ªé«˜ï¼ˆå·²é™ä½åˆ°0.3ï¼‰
- word_idxæ¨è¿›ç­–ç•¥ä¸å½“
- å‰ç»èŒƒå›´ä¸å¤Ÿï¼ˆå·²æå‡åˆ°20ï¼‰

---

### åŸå› 2ï¼šLLMä¿®æ”¹äº†åŸå§‹å†…å®¹ âš ï¸
**è¡¨ç°ï¼š**
- LLMå¯èƒ½æ”¹å†™äº†æŸäº›å¥å­
- ä¾‹å¦‚ï¼š"I was very delayed" â†’ "It was very delayed"
- å¯¼è‡´è¯å¯¹ä¸ä¸Š

**éªŒè¯æ–¹æ³•ï¼š**
å¯¹æ¯”LLMè¾“å‡ºå’ŒåŸå§‹å­—å¹•ï¼š
```bash
# LLMè¾“å‡º
"MÃ©decins Sans FrontiÃ¨res"

# Whisperè¯†åˆ«
"medicine, some frontiers"

â†’ å®Œå…¨ä¸åŒï¼æ— æ³•åŒ¹é…ï¼
```

---

### åŸå› 3ï¼šè¯çº§æ—¶é—´æˆ³æœ‰é—®é¢˜ âš ï¸
**è¡¨ç°ï¼š**
- Whisperè¯†åˆ«é”™è¯¯
- æ¼è¯
- æ—¶é—´æˆ³ä¸å‡†

**éªŒè¯æ–¹æ³•ï¼š**
æ£€æŸ¥word_basedå­—å¹•ï¼š
```srt
124
00:08:00,920 --> 00:08:04,959
We don't have to afford Kansas to get a year go down
                  ^^^^^^ ^^^^^^      ^^^ ^ ^^^^
                  é”™è¯¯è¯†åˆ«ï¼åº”è¯¥æ˜¯ "hoard cans and go"
```

**ç»“è®ºï¼š** è¯çº§æ—¶é—´æˆ³æœ¬èº«æœ‰è¯†åˆ«é”™è¯¯ï¼

---

## âœ… å·²å®æ–½çš„ä¿®å¤

### ä¿®å¤1ï¼šå¢å¼ºè¯Šæ–­æ—¥å¿—
```python
# æ˜¾ç¤ºé™„è¿‘çš„Whisperè¯†åˆ«è¯
if word_idx < len(words):
    nearby_words = []
    for j in range(word_idx, min(word_idx + 5, len(words))):
        nearby_words.append(words[j]['word'])
    self.progress.emit(f'      é™„è¿‘çš„è¯: {" ".join(nearby_words)}')
```

**ä½œç”¨ï¼š** å¯ä»¥çœ‹åˆ°ä¸ºä»€ä¹ˆåŒ¹é…ä¸ä¸Š

---

### ä¿®å¤2ï¼šæ™ºèƒ½æ¨è¿›ç­–ç•¥
```python
# åŸºäºè¿›åº¦æ¯”ä¾‹æ¨è¿›
progress_ratio = (i + 1) / len(segments)
target_idx = int(len(words) * progress_ratio)
jump = max(10, target_idx - word_idx)
word_idx = min(word_idx + jump, len(words) - 10)
```

**ä½œç”¨ï¼š**
- ä¸å†å›ºå®šè·³5ä¸ªè¯
- æ ¹æ®å¤„ç†è¿›åº¦åŠ¨æ€è®¡ç®—åº”è¯¥è·³å¤šå°‘
- é¿å…word_idxæå‰ç”¨å®Œ

---

### ä¿®å¤3ï¼šåŠ¨æ€åŒ¹é…é˜ˆå€¼
```python
# å¦‚æœæ¥è¿‘å°¾éƒ¨ï¼Œæ”¾å®½åŒ¹é…æ¡ä»¶
remaining_segments = len(segments) - i
remaining_words = len(words) - word_idx
is_near_end = remaining_words < remaining_segments * 5

# åŠ¨æ€é˜ˆå€¼
threshold = 0.2 if relax else 0.3  # å°¾éƒ¨é™åˆ°0.2
```

**ä½œç”¨ï¼š**
- å‰æœŸä¸¥æ ¼åŒ¹é…ï¼ˆé˜ˆå€¼0.3ï¼‰
- å°¾éƒ¨æ”¾å®½ï¼ˆé˜ˆå€¼0.2ï¼‰
- é¿å…å°¾éƒ¨å¤§é‡å¤±è´¥

---

### ä¿®å¤4ï¼šå¢å¼ºåŒ¹é…ç®—æ³•
```python
max_lookahead = 20  # ä»15æå‡åˆ°20
score = score - (offset * 0.05)  # ä½ç½®æƒ©ç½šä»0.1é™åˆ°0.05

# æ™ºèƒ½æ¨è¿›
if consecutive_misses >= 2:
    word_idx = min(word_idx + 1, len(words) - 1)
    consecutive_misses = 0
```

---

## ğŸ”¬ é‡æ–°æµ‹è¯•ï¼ˆæŸ¥çœ‹è¯¦ç»†è¯Šæ–­ï¼‰

```bash
cd /Users/mark/Downloads/pyvideotrans/get_srt_zimu
uv run python main.py
```

### æœŸæœ›çœ‹åˆ°çš„æ—¥å¿—

#### æˆåŠŸåŒ¹é…ï¼š
```
âœ“ Segment 51: "Third, it didn't get into many urban areas."
   åŒ¹é…è¯æ•°: 8/8 (100%)
```

#### å¤±è´¥ä½†æœ‰è¯Šæ–­ï¼š
```
âš ï¸  Segment 52 æ— æ³•åŒ¹é…ï¼ˆå·²è·³è¿‡ 1 ä¸ªï¼‰
   å½“å‰ word_idx: 550/1230
   æ–‡æœ¬: "And that was just luck."
   é™„è¿‘çš„è¯: that was just lock the  â† çœ‹ï¼"luck"è¢«è¯†åˆ«æˆ"lock"ï¼
   â†’ åŸºäºè¿›åº¦æ¨è¿› word_idx åˆ° 560 (è·³è·ƒ10ä¸ªè¯)
```

#### å°¾éƒ¨æ”¾å®½åŒ¹é…ï¼š
```
âœ“ Segment 110: "Finally we need lots of advanced R&D..."
   [æ”¾å®½æ¨¡å¼] é˜ˆå€¼=0.2, åŒ¹é…è¯æ•°: 5/12 (42%)
   â†’ æˆåŠŸï¼ï¼ˆå› ä¸ºé™ä½äº†é˜ˆå€¼ï¼‰
```

---

## ğŸ“ˆ é¢„æœŸæ”¹è¿›

| é¡¹ç›® | ä¿®å¤å‰ | é¢„æœŸä¿®å¤å |
|------|--------|-----------|
| **åŒ¹é…ç‡** | 66% (88/133) | **90%+** (120+/133) |
| **å°¾éƒ¨å¤±è´¥** | 25æ¡è¿ç»­å¤±è´¥ | **<5æ¡å¤±è´¥** |
| **è¯Šæ–­èƒ½åŠ›** | æ— æ³•çŸ¥é“åŸå›  | **è¯¦ç»†æ˜¾ç¤ºåŸå› ** |

---

## ğŸ¯ ä¸‰ä¸ªåŸå› çš„ç»“è®º

ç»è¿‡åˆ†æï¼Œ**ä¸‰ä¸ªåŸå› éƒ½å­˜åœ¨**ï¼š

### 1ï¸âƒ£ åŒ¹é…ç®—æ³•é—®é¢˜ï¼ˆä¸»è¦ï¼‰âœ… å·²ä¿®å¤
- é˜ˆå€¼å¤ªé«˜
- æ¨è¿›ç­–ç•¥ä¸å½“
- å‰ç»èŒƒå›´ä¸å¤Ÿ

### 2ï¸âƒ£ LLMä¿®æ”¹å†…å®¹ï¼ˆæ¬¡è¦ï¼‰âš ï¸ æ— æ³•å®Œå…¨é¿å…
- LLMç¡®å®ä¼šæ”¹å†™æŸäº›å†…å®¹
- ä¾‹å¦‚ï¼šçº æ­£é”™è¯¯è¯†åˆ«çš„è¯
- è¿™æ˜¯æ­£å¸¸çš„ï¼Œä½†ä¼šå¯¼è‡´åŒ¹é…å¤±è´¥

### 3ï¸âƒ£ è¯çº§æ—¶é—´æˆ³é”™è¯¯ï¼ˆæ ¹æœ¬ï¼‰âš ï¸ æ— æ³•ä¿®å¤
- Whisperæœ¬èº«ä¼šè¯†åˆ«é”™è¯¯
- ä¾‹å¦‚ï¼š"luck" â†’ "lock"
- è¿™æ˜¯è¯­éŸ³è¯†åˆ«çš„å›ºæœ‰é™åˆ¶

---

## ğŸ’¡ æœ€ç»ˆæ–¹æ¡ˆ

### çŸ­æœŸï¼šä¼˜åŒ–åŒ¹é…ç®—æ³• âœ…
- åŠ¨æ€é˜ˆå€¼
- æ™ºèƒ½æ¨è¿›
- è¯¦ç»†è¯Šæ–­

### ä¸­æœŸï¼šå…è®¸éƒ¨åˆ†åŒ¹é…
å³ä½¿æŸäº›è¯åŒ¹é…ä¸ä¸Šï¼Œä¹Ÿç”Ÿæˆå­—å¹•ï¼ˆå·²å®ç°ï¼‰

### é•¿æœŸï¼šä¸¤éåŒ¹é…
```python
# ç¬¬ä¸€éï¼šä¸¥æ ¼åŒ¹é…
subtitles = match_pass1(segments, words, threshold=0.3)

# ç¬¬äºŒéï¼šæ”¾å®½åŒ¹é…å¤±è´¥çš„segments
failed = get_failed_segments()
additional = match_pass2(failed, words, threshold=0.2, allow_skip=True)

# åˆå¹¶å¹¶æ’åº
all_subtitles = sort_by_time(subtitles + additional)
```

---

## ğŸ“ ä¸‹ä¸€æ­¥

1. âœ… é‡æ–°è¿è¡Œï¼ŒæŸ¥çœ‹è¯Šæ–­æ—¥å¿—
2. ğŸ“Š åˆ†æå“ªäº›segmentsåŒ¹é…ä¸ä¸Šä»¥åŠåŸå› 
3. ğŸ”§ æ ¹æ®è¯Šæ–­ç»“æœè¿›ä¸€æ­¥è°ƒæ•´
4. ğŸ¯ ç›®æ ‡ï¼šåŒ¹é…ç‡è¾¾åˆ° **95%+**

---

**ç°åœ¨é‡æ–°æµ‹è¯•ï¼Œä»”ç»†æŸ¥çœ‹è¯Šæ–­æ—¥å¿—ï¼** ğŸ”

