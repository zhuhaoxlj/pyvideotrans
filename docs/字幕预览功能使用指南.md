# 字幕预览功能使用指南

## 🎬 功能介绍

在"视频、音频、字幕三者合并"页面中，我们新增了**实时字幕预览**功能！现在您可以在调整字幕样式时，直观地看到字幕在实际视频上的显示效果。

## 📋 使用步骤

### 第一步：打开功能页面
1. 启动程序
2. 找到并打开"视频、音频、字幕三者合并"功能

### 第二步：选择视频文件
1. 点击"选择视频文件"按钮
2. 选择您要处理的视频文件
3. **自动预览**：系统会自动从视频中截取一帧，并在预览区域显示

### 第三步：调整字幕参数
现在您可以调整各种字幕参数，每次修改后预览会自动更新（延迟0.5秒）：

#### 位置和边距
- **位置**：选择字幕在视频中的位置（左上、居中、底部等）
- **左边距**：调整字幕距离左边的距离
- **垂直边距**：调整字幕距离上下的距离
- **右边距**：调整字幕距离右边的距离

#### 字体样式
- **字体大小**：输入数字设置字体大小（如16、20、24等）
- **选择字体**：点击按钮选择您喜欢的字体
- **字体颜色**：点击按钮选择字体颜色（支持透明度）

#### 效果设置
- **轮廓大小**：设置字体轮廓的粗细
- **阴影大小**：设置字体阴影的大小
- **背景阴影色**：设置背景或阴影的颜色
- **轮廓色**：设置字体轮廓的颜色
- **背景色块风格**：勾选后使用背景色块而非轮廓描边

### 第四步：查看预览效果
- 预览区域会实时显示您的字幕设置效果
- 如果需要立即查看效果，点击"刷新预览"按钮

## 💡 使用技巧

### 1. 快速调整
- 快速连续调整多个参数时，预览会等到您停止操作后0.5秒才更新
- 这样可以避免频繁渲染，提高响应速度

### 2. 手动刷新
- 如果觉得自动更新太慢，可以点击"刷新预览"按钮立即更新
- 手动刷新会跳过延迟，立即显示最新效果

### 3. 软字幕模式
- 如果勾选"嵌入软字幕"，预览区域只会显示原始视频帧
- 这是因为软字幕不会直接绘制在视频上，而是存储在视频容器中

### 4. 预览文本
- 预览使用的是示例文本："这是字幕预览效果 / Subtitle Preview Effect"
- 实际处理时会使用您选择的字幕文件

## 📐 预览区域说明

- **尺寸**：预览区域固定为 640×360 像素
- **位置**：显示在界面顶部
- **背景**：深灰色背景，便于查看字幕效果
- **缩放**：视频帧会自动缩放以适应预览区域，保持宽高比

## ⚙️ 支持的字幕参数

✅ 字幕位置（9种位置选项）  
✅ 左边距、垂直边距、右边距  
✅ 字体类型和大小  
✅ 字体颜色（含透明度）  
✅ 背景颜色（含透明度）  
✅ 轮廓颜色（含透明度）  
✅ 轮廓大小  
✅ 阴影大小  
✅ 背景色块风格  

## ❓ 常见问题

### Q1: 为什么选择视频后需要等待几秒？
A: 系统需要使用FFmpeg从视频中提取一帧图片，对于大视频文件可能需要几秒时间。

### Q2: 预览的字幕和实际处理的字幕一样吗？
A: 预览使用的是示例文本，但样式设置是完全相同的。实际处理时会使用您选择的字幕文件内容。

### Q3: 为什么软字幕模式下看不到字幕？
A: 软字幕是嵌入到视频文件中的独立字幕轨道，不会直接绘制在视频画面上。播放器可以选择是否显示软字幕。

### Q4: 可以预览不同时间点的视频帧吗？
A: 目前预览固定使用视频中间位置的帧。如果需要查看其他时间点，建议在实际处理后检查输出视频。

### Q5: 预览卡顿怎么办？
A: 预览使用了防抖机制，快速调整参数时会等待0.5秒。如果觉得慢，可以先调整好所有参数，再点击"刷新预览"按钮。

## 🔧 技术要求

- ✅ 需要安装FFmpeg
- ✅ 需要Python环境和PySide6
- ✅ 需要足够的临时存储空间

## 📝 注意事项

1. **临时文件**：预览功能会在临时目录创建一些文件，这些文件会自动清理
2. **性能**：预览需要调用FFmpeg，首次预览可能需要几秒时间
3. **分辨率**：预览区域的分辨率固定，不影响最终输出视频的分辨率
4. **更新频率**：为避免频繁渲染，自动更新有0.5秒延迟

## 🎉 使用示例

### 场景1：调整底部字幕
1. 选择视频文件
2. 位置选择：bottom-center
3. 垂直边距：20
4. 字体大小：24
5. 字体颜色：白色
6. 轮廓：黑色，大小2
7. 查看预览，确认效果满意

### 场景2：创建顶部标题
1. 选择视频文件
2. 位置选择：top-center
3. 垂直边距：30
4. 字体大小：32
5. 选择粗体字体
6. 背景色块风格：勾选
7. 背景阴影色：半透明黑色
8. 查看预览

## 📞 反馈与支持

如果您在使用过程中遇到问题或有改进建议，欢迎反馈！

---

**更新日期**：2025-10-09  
**版本**：1.0

