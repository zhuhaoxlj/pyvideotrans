# è§†é¢‘å¸§ç‡æ£€æµ‹åŠŸèƒ½ / Video FPS Detection Feature

## åŠŸèƒ½ç®€ä»‹ / Overview

åœ¨ PyVideoTrans å·¥å…·é›†çš„ä¸»ç•Œé¢ä¸­ï¼Œç°åœ¨æ–°å¢äº†ä¸€ä¸ªè§†é¢‘å¸§ç‡æ£€æµ‹åŒºåŸŸã€‚æ‚¨å¯ä»¥é€šè¿‡æ‹–æ‹½è§†é¢‘æ–‡ä»¶åˆ°è¯¥åŒºåŸŸï¼Œå¿«é€ŸæŸ¥çœ‹è§†é¢‘çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬å¸§ç‡ã€åˆ†è¾¨ç‡ã€ç¼–ç æ ¼å¼ç­‰ã€‚

The main menu of PyVideoTrans Tools now includes a video FPS detection area. You can drag and drop video files to quickly view detailed information including FPS, resolution, codec, and more.

## åŠŸèƒ½ç‰¹ç‚¹ / Features

### ä¸­æ–‡ç‰ˆ

- **åŒé‡äº¤äº’æ–¹å¼**ï¼š
  - ğŸ–±ï¸ ç‚¹å‡»åŒºåŸŸæ‰“å¼€æ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†
  - ğŸ“‚ æ‹–æ‹½è§†é¢‘æ–‡ä»¶ç›´æ¥åˆ°æ£€æµ‹åŒºåŸŸ
- **å¤šæ ¼å¼æ”¯æŒ**ï¼šæ”¯æŒå¸¸è§çš„è§†é¢‘æ ¼å¼ï¼ˆMP4ã€MOVã€AVIã€MKVã€FLVã€WMVã€WEBMã€M4Vã€MPEGã€MPGï¼‰
- **è¯¦ç»†ä¿¡æ¯**ï¼šæ˜¾ç¤ºè§†é¢‘çš„å®Œæ•´ä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼š
  - å¸§ç‡ (FPS) - ç™½è‰²å¤§å­—æ¸…æ™°æ˜¾ç¤º
  - åˆ†è¾¨ç‡ï¼ˆå®½Ã—é«˜ï¼‰
  - è§†é¢‘ç¼–ç æ ¼å¼
  - è§†é¢‘æ—¶é•¿
- **å®æ—¶åˆ†æ**ï¼šé€‰æ‹©æˆ–æ‹–å…¥è§†é¢‘åç«‹å³åˆ†æå¹¶æ˜¾ç¤ºç»“æœ
- **å‹å¥½æç¤º**ï¼šæ¸…æ™°çš„è§†è§‰åé¦ˆå’Œé”™è¯¯æç¤º
- **ç®€æ´ç¾è§‚**ï¼šæ— èƒŒæ™¯æ¡å¹²æ‰°ï¼Œçº¯ç™½è‰²å­—ä½“æ˜¾ç¤º

### English

- **Dual Interaction Methods**:
  - ğŸ–±ï¸ Click area to open file selection dialog
  - ğŸ“‚ Drag and drop video files directly to the detection area
- **Multi-format Support**: Supports common video formats (MP4, MOV, AVI, MKV, FLV, WMV, WEBM, M4V, MPEG, MPG)
- **Detailed Information**: Displays complete video information including:
  - Frame rate (FPS) - Clearly displayed in large white text
  - Resolution (widthÃ—height)
  - Video codec
  - Duration
- **Real-time Analysis**: Instant analysis and display of results after selecting or dropping video
- **User-friendly**: Clear visual feedback and error messages
- **Clean & Beautiful**: No background bars, pure white text display

## ä½¿ç”¨æ–¹æ³• / How to Use

### ä¸­æ–‡ç‰ˆ

1. **å¯åŠ¨ç¨‹åº**ï¼šè¿è¡Œ PyVideoTrans ä¸»ç¨‹åº
   ```bash
   python main.py
   ```

2. **æ‰¾åˆ°æ£€æµ‹åŒºåŸŸ**ï¼šåœ¨ä¸»ç•Œé¢ä¸‹æ–¹å¯ä»¥çœ‹åˆ°ä¸€ä¸ªç°è‰²çš„è™šçº¿è¾¹æ¡†åŒºåŸŸï¼Œæ ‡æœ‰"ğŸ“¹ ç‚¹å‡»æˆ–æ‹–å…¥è§†é¢‘æ–‡ä»¶æ£€æµ‹å¸§ç‡"

3. **é€‰æ‹©è§†é¢‘**ï¼šæœ‰ä¸¤ç§æ–¹å¼
   - **æ–¹æ³•ä¸€**ï¼šç‚¹å‡»è¯¥åŒºåŸŸï¼Œä¼šå¼¹å‡ºæ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†ï¼Œé€‰æ‹©è§†é¢‘æ–‡ä»¶
   - **æ–¹æ³•äºŒ**ï¼šå°†è§†é¢‘æ–‡ä»¶ä»æ–‡ä»¶ç®¡ç†å™¨æ‹–æ‹½åˆ°è¯¥åŒºåŸŸ

4. **æŸ¥çœ‹ç»“æœ**ï¼šç³»ç»Ÿä¼šè‡ªåŠ¨åˆ†æè§†é¢‘å¹¶æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯
   - æ–‡ä»¶åã€åˆ†è¾¨ç‡ã€ç¼–ç ã€æ—¶é•¿ä¼šæ˜¾ç¤ºåœ¨åŒºåŸŸä¸­éƒ¨
   - å¸§ç‡ä¼šä»¥å¤§å·ç™½è‰²å­—ä½“æ˜¾ç¤ºåœ¨ä¸‹æ–¹

### English

1. **Start Program**: Run the PyVideoTrans main program
   ```bash
   python main.py
   ```

2. **Locate Detection Area**: Find the gray dashed border area at the bottom of the main interface, marked "ğŸ“¹ Click or Drag Video to Detect FPS"

3. **Select Video**: Two methods available
   - **Method 1**: Click the area to open file selection dialog and choose a video file
   - **Method 2**: Drag and drop video files from file manager to the area

4. **View Results**: The system will automatically analyze the video and display detailed information
   - Filename, resolution, codec, and duration will be shown in the middle
   - FPS will be displayed in large white text at the bottom

## ç•Œé¢è¯´æ˜ / Interface Description

### ä¸­æ–‡ç‰ˆ

æ£€æµ‹åŒºåŸŸåŒ…å«ä¸‰ä¸ªéƒ¨åˆ†ï¼š

1. **æç¤ºæ ‡ç­¾**ï¼šæ˜¾ç¤º"ğŸ“¹ ç‚¹å‡»æˆ–æ‹–å…¥è§†é¢‘æ–‡ä»¶æ£€æµ‹å¸§ç‡"ï¼Œæç¤ºç”¨æˆ·å¯ä»¥ç‚¹å‡»æˆ–æ‹–æ‹½
2. **ä¿¡æ¯æ ‡ç­¾**ï¼šæ˜¾ç¤ºè§†é¢‘æ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯ï¼ˆæ–‡ä»¶åã€åˆ†è¾¨ç‡ã€ç¼–ç ã€æ—¶é•¿ï¼‰
3. **å¸§ç‡æ ‡ç­¾**ï¼šä»¥å¤§å·ç™½è‰²å­—ä½“æ˜¾ç¤ºè§†é¢‘çš„å¸§ç‡ï¼ˆåˆ†æå‰éšè—ï¼‰

**äº¤äº’åé¦ˆ**ï¼š
- é¼ æ ‡æ‚¬åœæ—¶å…‰æ ‡å˜ä¸ºæ‰‹å‹ï¼Œæç¤ºå¯ç‚¹å‡»
- æ‹–å…¥æ–‡ä»¶æ—¶è¾¹æ¡†é¢œè‰²ä¼šå˜åŒ–
- ç‚¹å‡»åä¼šå¼¹å‡ºç³»ç»Ÿæ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†

### English

The detection area consists of three parts:

1. **Hint Label**: Shows "ğŸ“¹ Click or Drag Video to Detect FPS", indicating users can click or drag
2. **Info Label**: Displays detailed video information (filename, resolution, codec, duration)
3. **FPS Label**: Shows the video frame rate in large white text (hidden before analysis)

**Interaction Feedback**:
- Cursor changes to pointer on hover, indicating clickable
- Border color changes when dragging files
- File selection dialog appears after clicking

## æŠ€æœ¯å®ç° / Technical Implementation

### ä¸­æ–‡ç‰ˆ

è¯¥åŠŸèƒ½åŸºäº FFmpeg çš„ ffprobe å·¥å…·å®ç°ï¼Œé€šè¿‡è°ƒç”¨ `get_video_info()` å‡½æ•°è·å–è§†é¢‘çš„å®Œæ•´ä¿¡æ¯ã€‚ä¸»è¦åŒ…æ‹¬ï¼š

- **åŒé‡äº¤äº’å¤„ç†**ï¼š
  - å®ç°äº† `mousePressEvent` æ–¹æ³•å¤„ç†ç‚¹å‡»äº‹ä»¶ï¼Œæ‰“å¼€æ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†
  - å®ç°äº† `dragEnterEvent` å’Œ `dropEvent` æ–¹æ³•å¤„ç†æ‹–æ”¾äº‹ä»¶
- **æ–‡ä»¶æ ¼å¼éªŒè¯**ï¼šæ£€æŸ¥æ–‡ä»¶æ‰©å±•åæ˜¯å¦ä¸ºæ”¯æŒçš„è§†é¢‘æ ¼å¼
- **è§†é¢‘ä¿¡æ¯æå–**ï¼šä½¿ç”¨ ffprobe åˆ†æè§†é¢‘æ–‡ä»¶
- **ç•Œé¢ä¼˜åŒ–**ï¼š
  - é¼ æ ‡æ‚¬åœæ—¶æ˜¾ç¤ºæ‰‹å‹å…‰æ ‡
  - ä½¿ç”¨çº¯ç™½è‰²æ–‡å­—ï¼Œæ— èƒŒæ™¯æ¡å¹²æ‰°
  - è‡ªé€‚åº”å¸ƒå±€ï¼Œåˆç†çš„è¾¹è·å’Œé—´è·
- **å‹å¥½çš„é”™è¯¯å¤„ç†**ï¼šæ•è·å¹¶æ˜¾ç¤ºåˆ†æè¿‡ç¨‹ä¸­çš„é”™è¯¯

### English

This feature is implemented using FFmpeg's ffprobe tool, calling the `get_video_info()` function to retrieve complete video information. Key components include:

- **Dual Interaction Handling**:
  - Implements `mousePressEvent` method to handle click events and open file selection dialog
  - Implements `dragEnterEvent` and `dropEvent` methods to handle drag & drop events
- **File Format Validation**: Checks if file extension matches supported video formats
- **Video Information Extraction**: Uses ffprobe to analyze video files
- **UI Optimization**:
  - Shows pointer cursor on hover
  - Uses pure white text without background bars
  - Adaptive layout with proper margins and spacing
- **User-friendly Error Handling**: Captures and displays errors during analysis

## ä»£ç ç¤ºä¾‹ / Code Example

### æµ‹è¯•è„šæœ¬ / Test Script

é¡¹ç›®ä¸­åŒ…å«äº†ä¸€ä¸ªæµ‹è¯•è„šæœ¬ `test_fps_detection.py`ï¼Œå¯ä»¥ç”¨æ¥æµ‹è¯•è§†é¢‘ä¿¡æ¯è·å–åŠŸèƒ½ï¼š

```bash
python test_fps_detection.py
```

è¾“å‡ºç¤ºä¾‹ / Sample Output:
```
ğŸ“¹ æµ‹è¯•è§†é¢‘: How parades can build community _ Chantelle Rytter _ TEDxAtlanta.mp4
============================================================
âœ… è§†é¢‘ä¿¡æ¯è·å–æˆåŠŸï¼
   å¸§ç‡ (FPS): 29.97
   åˆ†è¾¨ç‡: 1280x720
   è§†é¢‘ç¼–ç : h264
   éŸ³é¢‘ç¼–ç : aac
   æ—¶é•¿: 511.72 ç§’
   è§†é¢‘æµæ•°é‡: 2
   éŸ³é¢‘æµæ•°é‡: 1
   åƒç´ æ ¼å¼: yuv420p
============================================================
âœ… æµ‹è¯•é€šè¿‡ï¼å¸§ç‡æ£€æµ‹åŠŸèƒ½æ­£å¸¸å·¥ä½œã€‚
```

## ç›¸å…³æ–‡ä»¶ / Related Files

- `videotrans/ui/main_menu.py` - ä¸»ç•Œé¢ UI å®šä¹‰
- `videotrans/component/set_form.py` - ä¸»èœå•çª—å£å®ç°ï¼ˆåŒ…å«æ‹–æ”¾é€»è¾‘ï¼‰
- `videotrans/util/help_ffmpeg.py` - FFmpeg å·¥å…·å‡½æ•°ï¼ˆåŒ…å« `get_video_info()`ï¼‰
- `test_fps_detection.py` - æµ‹è¯•è„šæœ¬

## æ³¨æ„äº‹é¡¹ / Notes

### ä¸­æ–‡ç‰ˆ

1. éœ€è¦ç¡®ä¿ç³»ç»Ÿä¸­å·²å®‰è£… FFmpeg å¹¶é…ç½®äº†æ­£ç¡®çš„è·¯å¾„
2. å¤§å‹è§†é¢‘æ–‡ä»¶å¯èƒ½éœ€è¦ç¨é•¿çš„åˆ†ææ—¶é—´
3. å¦‚æœåˆ†æå¤±è´¥ï¼Œä¼šæ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯æç¤º

### English

1. Ensure FFmpeg is installed and properly configured in your system
2. Large video files may require more time for analysis
3. Error messages will be displayed if analysis fails

## æ›´æ–°æ—¥å¿— / Changelog

### v1.1.0 (2025-11-01)

- âœ¨ æ–°å¢ç‚¹å‡»é€‰æ‹©æ–‡ä»¶åŠŸèƒ½
- ğŸ¨ ä¼˜åŒ–ç•Œé¢æ˜¾ç¤ºï¼Œå»é™¤èƒŒæ™¯æ¡
- ğŸ¨ æ”¹ç”¨çº¯ç™½è‰²å­—ä½“æ˜¾ç¤ºå¸§ç‡ä¿¡æ¯
- ğŸ¨ å¢å¤§å­—ä½“ï¼Œæå‡å¯è¯»æ€§
- ğŸ–±ï¸ æ·»åŠ é¼ æ ‡æ‚¬åœæ‰‹å‹å…‰æ ‡æç¤º
- ğŸ“ æ›´æ–°æç¤ºæ–‡å­—ä¸º"ç‚¹å‡»æˆ–æ‹–å…¥è§†é¢‘æ–‡ä»¶æ£€æµ‹å¸§ç‡"

### v1.0.0 (2025-11-01)

- âœ¨ æ–°å¢è§†é¢‘å¸§ç‡æ£€æµ‹åŒºåŸŸ
- âœ¨ æ”¯æŒæ‹–æ‹½è§†é¢‘æ–‡ä»¶
- âœ¨ æ˜¾ç¤ºå®Œæ•´çš„è§†é¢‘ä¿¡æ¯ï¼ˆå¸§ç‡ã€åˆ†è¾¨ç‡ã€ç¼–ç ã€æ—¶é•¿ï¼‰
- âœ¨ æ”¯æŒä¸­è‹±æ–‡ç•Œé¢
- âœ¨ æ·»åŠ å‹å¥½çš„é”™è¯¯å¤„ç†å’Œæç¤º

---

**Developed with â¤ï¸ for PyVideoTrans**

